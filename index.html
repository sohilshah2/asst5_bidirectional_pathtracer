<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Assignment 5: Bidirectional Pathtracer by sohilshah2</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Assignment 5: Bidirectional Pathtracer</h1>
          <h2></h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/sohilshah2/asst5_bidirectional_pathtracer/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/sohilshah2/asst5_bidirectional_pathtracer/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/sohilshah2/asst5_bidirectional_pathtracer" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="assignment-5-project-idea-proposal" class="anchor" href="#assignment-5-project-idea-proposal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Assignment 5 Project Idea Proposal</h1>

<h4>
<a id="author-sohil-shah-sohils" class="anchor" href="#author-sohil-shah-sohils" aria-hidden="true"><span class="octicon octicon-link"></span></a>Author: Sohil Shah (sohils)</h4>

<p>For this project, I would like to implement a bidirectional path tracing algorithm by extending the assignment 3 code. The main goal of this would be to render correct images with lower variance according to the same wall clock time. This should also help greatly with effects such as caustics due to the faster convergence of the integral. </p>

<h2>
<a id="plan" class="anchor" href="#plan" aria-hidden="true"><span class="octicon octicon-link"></span></a>Plan</h2>

<p>To accomplish this project, these are the things that need to be done:<br>
        1. The pathtracer will be modified to shoot rays from both the light sources and the camera.<br>
        2. The rays from light sources and the camera will then be independently traced.<br>
        3. Endpoints from each of the two types of ray paths will be connected to compute contribution of radiance along each path.<br>
        4. Finally, each path will be weighted according to the probability of choosing that path connection.  </p>

<h2>
<a id="ideal-result" class="anchor" href="#ideal-result" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ideal Result</h2>

<p>A correct implementation of this project will have the following features:<br>
        1. The project must converge to the same correct and unbiased images produced by the assignment 3 pathtracer.<br>
        2. Bidirectional pathtracing must converge faster than the original pathtracer.<br>
        3. Bidirectional pathtracing must converge in fewer samples per pixel than the original pathtracer.  </p>

<p>Images such as these shown below describe how bidirectional should look compared to regular pathtracing. The goal of this project is to match these results.  </p>

<p><img src="http://celarek.at/wp/wp-content/uploads/2014/06/veach_scene.jpg" alt=""><br>
Source: <a href="http://celarek.at/2014/06/global-illumination-rendering-using-path-tracing-and-bidirectional-path-tracing">http://celarek.at/2014/06/global-illumination-rendering-using-path-tracing-and-bidirectional-path-tracing</a>  </p>

<p><img src="https://adventuresinrendering.files.wordpress.com/2014/01/unidirectionalvsbidirectional-indirect-lighting-comparison.jpg" alt=""><br>
Source: <a href="https://adventuresinrendering.wordpress.com/">https://adventuresinrendering.wordpress.com/</a>  </p>

<h2>
<a id="potential-problems" class="anchor" href="#potential-problems" aria-hidden="true"><span class="octicon octicon-link"></span></a>Potential Problems</h2>

<p>The problems anticipated here mostly lie with the calculation of the probability of choosing a path. However, there is enough research already available on the internet about the subject that this should not pose an issue. If you have any comments on parts of this project that might pose a problem or could be particularly difficult please contact me.  </p>

<h1>
<a id="actual-results-and-implementation" class="anchor" href="#actual-results-and-implementation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Actual Results and Implementation</h1>

<p>The result of this project is a fairly successful bidirectional pathtracer. This pathtracer seems to do well rendering more interesting caustic effects and results in lower variance for many scenes. Its shortcomings are higher render time for identical sample count (which is expected) and high variance when a scene has a lot of delta materials. This is likely due to some mistakes in calculating pdfs when the path contains deltas. More work would have to go into calculating these distributions to reduce variance when a scene has lots of mirrors or glass. However, the implementation does give a lot of nice results.</p>

<h2>
<a id="build-instructions" class="anchor" href="#build-instructions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build instructions</h2>

<p>Building is same as assignment 3 code. Just go to the directory, and:<br>
<code>mkdir build ; cd build ; cmake .. ; make</code><br>
The command line arguments are also the same for the bidirectional pathtracer as the assignment 3 code. For quick and decent results, I recommend something like:<br>
<code>./pathtracer -t4 -s16 -l1 -m16 ../dae/sky/CBgems.dae</code></p>

<h2>
<a id="result-images" class="anchor" href="#result-images" aria-hidden="true"><span class="octicon octicon-link"></span></a>Result images</h2>

<p><img src="https://cloud.githubusercontent.com/assets/7096456/11853754/d7695b20-a40d-11e5-989f-5299fd82b143.png" alt=""><br>
Bidirectional: 2048 samples  </p>

<p><img src="https://cloud.githubusercontent.com/assets/7096456/11853767/ec73fbc4-a40d-11e5-99b4-71a4b7aad3e2.png" alt=""><br>
Standard Pathtracing: 4096 samples  </p>

<p>Here we can see a lower amount of noise with fewer samples. The bidirectional render finished quicker than the standard pathtracing version (about 1.3x faster). Even with fewer samples, the bidirectional render can be seen to have lower variance in areas that are hard to sample such as this shadow. </p>

<p><img src="https://cloud.githubusercontent.com/assets/7096456/11853753/d767ee8e-a40d-11e5-8a18-92f8d368a579.png" alt=""><br>
Bidirectional: Much better caustic sampling  </p>

<p>One thing we notice with the bidirectional renderer is that caustics are much more prominent. We can see effects that were not visible with standard pathtracing.  </p>

<p><img src="https://cloud.githubusercontent.com/assets/7096456/11853752/d767c616-a40d-11e5-80b4-a98342a4bb85.png" alt=""><br>
Bidirectional Caustics  </p>

<p><img src="https://cloud.githubusercontent.com/assets/7096456/11853769/ec78a4e4-a40d-11e5-9ea7-64aa82ea3eec.png" alt=""><br>
Standard Pathtracing Caustics  </p>

<p>This scene looks much better lit with bidirectional rendering.  </p>

<p><img src="https://cloud.githubusercontent.com/assets/7096456/11853751/d767b842-a40d-11e5-9dc5-3959b8811aa8.png" alt=""><br>
Bidirectional Caustics  </p>

<p><img src="https://cloud.githubusercontent.com/assets/7096456/11853768/ec77b37c-a40d-11e5-92de-e1213105b9c7.png" alt=""><br>
Standard Pathtracing Caustics  </p>

<p>Notice the caustic from the mirror dragon on the floor of the box. This was not visible before.  </p>

<h1>
<a id="known-implementation-problems" class="anchor" href="#known-implementation-problems" aria-hidden="true"><span class="octicon octicon-link"></span></a>Known Implementation Problems</h1>

<p>Though I would say this project was a success, there are a couple of known issues with it. </p>

<ul>
<li><p>First, the integrator may be biased as the images produced are often significantly different in lighting than those of the standard pathtracer. Certain areas are light more and others are darker. It is hard to prove whether this raytracer is biased or not.  </p></li>
<li><p>Second, although it converges in fewer samples than the standard pathtracer, rendering those samples takes much longer. It turns out that through testing, to get an image with a certain variance, the pathtracer takes about 2-3x more samples. However, the bidirectional pathtracer can render the same number of samples in about 1.5x-2x slower. Therefore, the speedup is usually not too significant.  </p></li>
<li><p>The bidirectional pathtracer produces high variance output images when a lot of delta materials are used. This is the biggest issue I see so far.  </p></li>
</ul>

<p>Based on these issues, I believe the best use for my implementation of the bidirectional pathtracer would be to render caustics. Maybe combine this with some other method that works better for delta materials to make it better. I think the issue is mainly with how the probabilities were calculated when delta materials were in the path.   </p>

<h1>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h1>

<p>A large portion of my research was from this paper by Eric Veach: <a href="https://graphics.stanford.edu/courses/cs348b-03/papers/veach-chapter10.pdf">https://graphics.stanford.edu/courses/cs348b-03/papers/veach-chapter10.pdf</a>  </p>

<p>Also used:</p>

<ul>
<li><a href="http://www.cescg.org/CESCG98/PDornbach/">http://www.cescg.org/CESCG98/PDornbach/</a></li>
<li>
<a href="https://adventuresinrendering.wordpress.com/2014/01/21/bidirectional-path-tracing-and-multiple-importance-sampling-part-1/">https://adventuresinrendering.wordpress.com/2014/01/21/bidirectional-path-tracing-and-multiple-importance-sampling-part-1/</a> </li>
<li><a href="https://adventuresinrendering.wordpress.com/2014/01/22/bidirectional-path-tracing-and-multiple-importance-sampling-part-2/">https://adventuresinrendering.wordpress.com/2014/01/22/bidirectional-path-tracing-and-multiple-importance-sampling-part-2/</a></li>
<li><a href="http://celarek.at/2014/06/global-illumination-rendering-using-path-tracing-and-bidirectional-path-tracing/">http://celarek.at/2014/06/global-illumination-rendering-using-path-tracing-and-bidirectional-path-tracing/</a></li>
</ul>
        </section>

        <footer>
          Assignment 5: Bidirectional Pathtracer is maintained by <a href="https://github.com/sohilshah2">sohilshah2</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
